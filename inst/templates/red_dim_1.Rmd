
### Dimension reduction plot:

<!-- Component created on {{ date }} -->

```{r}
{{ env_id }} = readRDS("envs/{{ env_id }}.rds")

is_shiny <- identical(knitr::opts_knit$get("rmarkdown.runtime"), "shiny")

########
library(dplyr)
########
reduced_dim <- {{ env_id }}$reduced_dim
metadata <- {{ env_id }}$metadata
grouping <- {{ env_id }}$grouping
labels <- {{ env_id }}$labels
# Create data.frame for linked plots

df_{{ env_id }} <- data.frame("x" = reduced_dim[,1], "y" = reduced_dim[,2], metadata)
row.names(df_{{ env_id }}) <- c()

sd_{{ env_id }} <- plotly::highlight_key(df_{{ env_id }})

```

```{r, eval=!is_shiny}
dots <- plotly::plot_ly(sd_{{ env_id }}, colors = "Set1", color = df_{{ env_id }}[[grouping]], x = ~x, y = ~y, mode = "markers", textposition = "top", hoverinfo = "x+y+text", text = paste("grouping: ", df_{{ env_id }}[[grouping]],"</br> label: ", labels )) %>%
  plotly::layout(
    xaxis = list(title = "Dim 1"),
    yaxis = list(title = "Dim 2"),
    showlegend = FALSE
  ) %>%
  plotly::highlight("plotly_selected")
dots
```

```{r, eval=is_shiny}
```

